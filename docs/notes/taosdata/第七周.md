# 日记

- bar gauge的max 设置
- panelCard的文字覆盖重合

- history-status的rect上的文字重合了
- rect的宽度、间隔待优化
- bar gauge，第一次加载数据会有undefined闪动
- bar gauge, 值的文字大小随柱条宽度而变化
- 支持name的placement调整

# 取整逻辑

```js
/**
 * 函数expandMinMax的计算逻辑：
 * 输入min、max，并计算range = max - min
 * 若range = 0，取min的20%作为pad上下扩充min、max，得到newMin、newMax
 * 否则，取range的20%作为pad上下扩充min、max，得到newMin、newMax
 * 若在newMin和min范围内有0，则取0作为最终的finalMin
 * 若在newMax和max范围内有0，则取0作为最终的finalMax
 * 否则在newMin和min范围中寻找finalMin、在newMax和max范围中寻找finalMax
 * 寻找逻辑为：【计算max逻辑】newVal从最高位向下取整，如果值在origVal和newVal之间，则取该值，如果不在，则newVal继续从第二高位向下取整，如此循环，直到满足在origVal和newVal之间；【计算min逻辑】：newVal从最高位向上取整，如果值在origVal和newVal之间，则取该值，如果不在，则newVal继续从第二高位向上取整，如此循环，直到满足在origVal和newVal之间；
 * 计算
 * 输出：finalMax、finalMin
getBestDigit(104, 65, 'max') expected: 100 OK
getBestDigit(189, 120, 'max') expected: 180 OK
getBestDigit(-46, -150, 'max') expected: -50
getBestDigit(0.8, 0.2, 'max') expected: 0.8 OK
getBestDigit(1100, 1234, 'min') expected: 1100 OK
getBestDigit(900, 1234, 'min') expected: 1000 OK
getBestDigit(-110, -56, 'min') expected: -100 OK
getBestDigit(-189, -120, 'min') expected: -180 OK
getBestDigit(190, 200, 'min') expected: 190 OK
getBestDigit(-0.8, -0.2, 'min') expected: -0.8 OK
getBestDigit(-0.987, -0.12, 'min') expected: -0.9
 */
```

- echarts 不支持坐标系label的位置配置到画面里，所以需要自定义绘制：
  - 水平模式下，需要设置bar的高度`barHeight`
    - 根据bar的高度计算得到label文字的大小`fontSize`
    - 由配置项`left、top`计算得到文字所占像素大小`fontPixelSize`
    - 得到单个条目的高度：`totalheight = barHeight + fontPixelSize`
    - echarts的bar的`gap = defaultGap + fontPixelSize`
  - 垂直模式下，无`left、top`模式

## 2.12

- 水平模式：添加名称显示到`左侧、顶部`功能
- 支持barSize控制（手动模式下）：
  - 水平模式：最小高度+最大高度
  - 垂直模式：最小宽度
  - label和value随barSize变化
- 处理多数据源显示错乱问题
